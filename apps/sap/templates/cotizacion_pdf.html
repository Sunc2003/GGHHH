<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Cotización {{ quotation.DocNum }}</title>
<style>
  body {
    font-family: 'Helvetica', sans-serif;
    margin: 0;
    padding: 0;
    color: #333;
  }

  @page {
    size: A4;
    margin: 12mm 10mm 15mm 10mm;
  }

  thead { display: table-header-group; }
  tr { page-break-inside: avoid; }

  /* ===== ENCABEZADO ===== */
  .header {
    background: linear-gradient(to right, #0B3C91, #0B3C91);
    color: white;
    padding: 10px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 3px solid #0B3C91;
  }

  .header-logo-main img {
    height: 68px;
    width: auto;
    object-fit: contain;
  }

  .header-logo {
    background: transparent;
    padding: 0;
    border-radius: 0;
    box-shadow: none;
  }

  .header-logo img {
    height: 140px;
    width: auto;
    object-fit: contain;
  }

  /* ===== BANDA CORPORATIVA ===== */
  .corp-bar {
    background: #EEF3FB;
    color: #0B3C91;
    font-size: 11px;
    text-align: center;
    padding: 6px 20px;
    font-weight: bold;
    border-bottom: 2px solid #0B3C91;
  }

  /* ===== INFO PRINCIPAL ===== */
  .info {
    display: flex;
    justify-content: space-between;
    gap: 15px;
    padding: 20px 25px 5px 25px;
  }

  .box {
    border: 1px solid #0B3C91;
    border-radius: 6px;
    padding: 12px 15px;
    width: 49%;
    background: #F8FAFF;
  }

  .box h3 {
    background: #0B3C91;
    color: white;
    padding: 7px;
    font-size: 13px;
    border-radius: 4px;
    margin: 0 0 8px 0;
    text-align: center;
    text-transform: uppercase;
  }

  .box p {
    margin: 3px 0;
    font-size: 12.2px;
    line-height: 1.3;
  }

  /* ===== MÉTODOS DE PAGO ===== */
  .metodos-container {
    text-align: center;
    margin: 18px 0 15px 0;
  }

  .metodos-titulo {
    color: #0B3C91;
    font-size: 12.8px;
    margin-bottom: 5px;
    font-weight: 700;
  }

  .metodos-bar {
    margin: 0 auto;
    width: 90%;
    border: 1px solid #0B3C91;
    background: #EEF3FB;
    border-radius: 6px;
    text-align: center;
    padding: 7px 10px;
    font-size: 12px;
    color: #0B3C91;
    font-weight: bold;
    letter-spacing: 0.3px;
    word-spacing: 3px;
  }

  .metodos-bar span { margin: 0 6px; }

  /* ===== TABLA PRODUCTOS ===== */
  .tabla-productos {
    width: 90%;
    margin: 18px auto 15px auto;
    border-collapse: collapse;
    font-size: 12px;
  }

  .tabla-productos th {
    background: #0B3C91;
    color: white;
    padding: 8px;
    text-align: center;
    border-bottom: 1px solid #0B3C91;
  }

  .tabla-productos td {
    border-bottom: 1px solid #ccc;
    padding: 6px 8px;
    vertical-align: middle;
  }

  /* ===== BLOQUE TOTALES ===== */
  .bloque-totales {
    width: 38%;
    margin: 20px 45px 0 auto;
    border: 1px solid #0B3C91;
    border-radius: 6px;
    background: #EEF3FB;
    padding: 10px 14px;
  }

  .totales {
    width: 100%;
    border-collapse: collapse;
    font-size: 12.2px;
  }

  .totales td { padding: 6px 0; }
  .totales .label {
    text-align: left;
    font-weight: bold;
    width: 60%;
  }
  .totales .value {
    text-align: right;
    width: 40%;
    white-space: nowrap;
  }
  .totales .total-final {
    border-top: 2px solid #0B3C91;
  }
  .totales .total-final .label {
    color: #0B3C91;
    font-size: 13px;
  }
  .totales .total-final .value {
    color: #0B3C91;
    font-weight: bold;
    font-size: 13.5px;
  }

  /* ===== COMENTARIOS Y FIRMA ===== */
  .comentarios-firma {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    width: 90%;
    margin: 35px auto 20px auto;
    page-break-inside: avoid;
  }

  .comentarios {
    width: 50%;
  }

  .comentarios label {
    font-weight: bold;
    font-size: 13px;
    color: #0B3C91;
  }

  .comentarios .cuadro {
    border: 1px solid #0B3C91;
    height: 65px;
    border-radius: 4px;
    margin-top: 6px;
    background: #F8FAFF;
  }

  .firma {
    text-align: center;
    width: 40%;
  }

  .firma-line {
    width: 180px;
    border-top: 1px solid #0B3C91;
    margin: 0 auto 6px auto;
  }

</style>
</head>
<body>

<!-- ===== ENCABEZADO ===== -->
<div class="header">
  <div class="header-logo-main">
    <img src="/static/img/logomarsella.png" alt="Ferretería Marsella Logo">
  </div>
  <div class="header-logo">
    <img src="/static/img/letrablanca.png" alt="Logo GGH">
  </div>
</div>

<!-- ===== BANDA CORPORATIVA ===== -->
<div class="corp-bar">
  Casa Matriz: Av. España 2501, Batuco, Lampa, Santiago |
  Sucursal Norte: El Quisco 678, Antofagasta |
  Tel: (56) 2 23539700 |
  Email: ventas@ggh.cl |
  Web: www.ferreteriamarsella.cl
</div>

<!-- ===== CUADROS DE INFORMACIÓN ===== -->
<div class="info">
  <div class="box">
    <h3>Datos del Cliente</h3>
    <p><b>Nombre:</b> {{ quotation.CardName }}</p>
    <p><b>RUT:</b> {{ quotation.FederalTaxID }}</p>
    <p><b>Dirección:</b> {{ quotation.Address }}</p>
    <p><b>Teléfono:</b> {{ quotation.Phone1 }}</p>
    <p><b>Solicitado por:</b> {{ quotation.SolicitadoPor }}</p>
  </div>

  <div class="box">
    <h3>Datos de la Cotización</h3>
    <p><b>N° Cotización:</b> {{ quotation.DocNum }}</p>
    <p><b>Fecha emisión:</b> {{ quotation.DocDate_fmt }}</p>
    <p><b>Fecha vencimiento:</b> {{ quotation.DocDueDate_fmt }}</p>
    <p><b>Vendedor:</b> {{ quotation.SalesPersonName }}</p>
    <p><b>Email:</b> {{ quotation.SalesPersonEmail }}</p>
    <p><b>Forma de Pago:</b> {{ quotation.FormaPago }}</p>
  </div>
</div>

<!-- ===== MÉTODOS DE PAGO ===== -->
<div class="metodos-container">
  <h4 class="metodos-titulo">MÉTODOS DE PAGO</h4>
  <div class="metodos-bar">
    <span>Transferencia</span> |
    <span>Khipu</span> |
    <span>WebPay</span> |
    <span>Mercado Pago</span> |
    <span><b>cobranzas@ggh.cl</b></span>
  </div>
</div>

<!-- ===== TABLA DE PRODUCTOS ===== -->
<table class="tabla-productos">
  <thead>
    <tr>
      <th style="width:10%">Código</th>
      <th style="width:30%">Descripción</th>
      <th style="width:8%">Cant.</th>
      <th style="width:10%">Unidad</th>
      <th style="width:12%">Plazo Entrega</th>
      <th style="width:15%">Precio Unitario</th>
      <th style="width:15%">Total</th>
    </tr>
  </thead>
  <tbody>
    {% for line in quotation.DocumentLines %}
    <tr>
      <td style="text-align:center;">{{ line.ItemCode }}</td>
      <td>{{ line.ItemDescription }}</td>
      <td style="text-align:center;">{{ line.Quantity|floatformat:0 }}</td>
      <td style="text-align:center;">{{ line.MeasureUnit|default:"-" }}</td>
      <td style="text-align:center;">{{ line.U_GGH_TIM|default:"-" }}</td>
      <td style="text-align:right;">${{ line.UnitPrice_fmt }}</td>
      <td style="text-align:right;">${{ line.LineTotal_fmt }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- ===== BLOQUE DE TOTALES ===== -->
<div class="bloque-totales">
  <table class="totales">
    <tr>
      <td class="label">Subtotal:</td>
      <td class="value">${{ neto }}</td>
    </tr>
    <tr>
      <td class="label">IVA (19%):</td>
      <td class="value">${{ iva }}</td>
    </tr>
    <tr class="total-final">
      <td class="label">TOTAL:</td>
      <td class="value">${{ total }}</td>
    </tr>
  </table>
</div>

<!-- ===== COMENTARIOS Y FIRMA ===== -->
<div class="comentarios-firma">
  <div class="comentarios">
    <label>Comentarios:</label>
    <div class="cuadro"></div>
  </div>
  <div class="firma">
    <div class="firma-line"></div>
    <p>Aceptación de Cliente</p>
  </div>
</div>

</body>
</html>
